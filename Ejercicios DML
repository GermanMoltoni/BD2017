CREATE DATABASE DML
USE DML
CREATE TABLE PROVEEDORES(
    NUMERO INT PRIMARY KEY AUTO_INCREMENT,
    NOMBRE VARCHAR(20) NOT NULL,
    DOMICILIO VARCHAR(20) NOT NULL,
    LOCALIDAD VARCHAR(20)
    )
CREATE TABLE PRODUCTOS (
	PNRO INT PRIMARY KEY AUTO_INCREMENT,
    PNOMBRE VARCHAR(20) NOT NULL ,
    PRECIO FLOAT NOT NULL,
    TAMAÑO VARCHAR(20),
    LOCALIDAD VARCHAR(20),
    CONSTRAINT CH_PRECIO CHECK('PRECIO' >=0)
)

CREATE TABLE PROV_PROD(
	NUMERO INT NOT NULL,
    PNRO INT NOT NULL,
    CANTIDAD INT NOT NULL,
    CONSTRAINT FK_NUMERO FOREIGN KEY (NUMERO) REFERENCES PROVEEDORES(NUMERO),
    CONSTRAINT FK_PNRO FOREIGN KEY (PNRO) REFERENCES PRODUCTOS(PNRO)

)
INSERT INTO PROVEEDORES VALUES (101,'Gomez','Nazca 920','Capital Federal'),
(102,'Perez','Argerich 1030','Capital Federal'),(103,'Vazquez','Sarmiento 450','Ramos Mejia')
,(104,'Lopez','Av Alsina 720','Avellaneda')

INSERT INTO PRODUCTOS VALUES(1,'Talco',5,'Chico','Capital Federal'),(2,'Talco',7,'Mediano','Capital Federal'),(3,'Crema',8,'Grande','Ramos Mejia'),
(4,'Cepillo',2,'Grande','Avellaneda'),(5,'Esmalte',1.2,'Normal','Chacarita')

INSERT INTO PROV_PROD VALUES (101,1,300),(101,2,200),(101,3,400),(101,4,200),(101,5,100),(102,1,300),(102,2,400),(103,2,200),(104,2,200),(104,4,300)

SELECT * FROM PRODUCTOS
SELECT * FROM PROVEEDORES WHERE LOCALIDAD='Capital Federal'
SELECT * FROM PROV_PROD WHERE CANTIDAD <=300 AND CANTIDAD >=200 O SELECT * FROM PROV_PROD WHERE CANTIDAD BETWEEN 200 AND 300
SELECT PP.PNRO FROM PROV_PROD AS PP,PROVEEDORES AS PR WHERE PP.NUMERO = PR.NUMERO AND PR.LOCALIDAD = 'Avellaneda'
SELECT SUM(CANTIDAD) AS CANTIDAD FROM PROV_PROD WHERE PNRO=1 AND NUMERO=103
SELECT PNRO,LOCALIDAD FROM PRODUCTOS WHERE LOCALIDAD LIKE '_A%'
SELECT PR.PRECIO FROM PROV_PROD AS PP, PRODUCTOS AS PR WHERE  PR.PNRO = PP.PNRO AND PP.NUMERO = 102
SELECT LOCALIDAD FROM PRODUCTOS UNION SELECT LOCALIDAD FROM PROVEEDORES
UPDATE PRODUCTOS SET TAMAÑO='Chico' WHERE TAMAÑO='Mediano'
DELETE FROM PRODUCTOS WHERE PNRO NOT IN (SELECT PNRO FROM PROV_PROD)
INSERT INTO PROVEEDORES VALUES(107,'Rosales','NULL','Wilde')

CREATE DATABASE DML_2
USE DML_2
CREATE TABLE PRODUCTOS(
	codigo_producto INT PRIMARY KEY AUTO_INCREMENT,
    nombre_producto VARCHAR(20) NOT NULL
)
CREATE TABLE CLIENTES(
	codigo_cliente INT PRIMARY KEY AUTO_INCREMENT,
    nombre VARCHAR(20) NOT NULL,
    domicilio VARCHAR(20),
    provincia VARCHAR(20) NOT NULL
)
CREATE TABLE ITEM_VENTAS(
	numero_factura INT  NOT NULL,
    codigo_producto INT NOT NULL,
    cantidad FLOAT NOT NULL,
    precio FLOAT NOT NULL,
    CONSTRAINT FK_COD_FAC FOREIGN KEY (numero_factura) REFERENCES VENTAS(numero_factura),

    CONSTRAINT FK_CODIGO_PROD FOREIGN KEY (codigo_producto) REFERENCES PRODUCTOS(codigo_producto)
)
CREATE TABLE VENTAS(
	numero_factura INT PRIMARY KEY AUTO_INCREMENT,
    codigo_cliente INT NOT NULL,
    fecha VARCHAR(20) NOT NULL,
    CONSTRAINT FK_COD_CLI FOREIGN KEY (codigo_cliente) REFERENCES CLIENTES(codigo_cliente)

)
INSERT INTO CLIENTES VALUES(1,'Jorge','Roca 321','Jujuy'),(2,'Pedro','Maipu 321','Mendoza'),(3,'Mario','Pergamino 441','Buenos Aires')
INSERT INTO PRODUCTOS VALUES(1,'Tuerca'),(2,'Mecha'),(3,'Tarugo'),(4,'Clavo'),(5,'Arandela'),(6,'Bulon')

INSERT INTO VENTAS VALUES(1,1,'17/01/2017'),(2,2,'27/01/2017'),(3,2,'17/05/2017'),(4,3,'17/01/2017'),(5,1,'17/03/2017')
INSERT INTO ITEM_VENTAS VALUES(1,2,100,400),(2,4,50,40),(3,1,20,15),(4,5,30,35)

SELECT MAX(cantidad) FROM ITEM_VENTAS
SELECT SUM(cantidad) FROM ITEM_VENTAS, PRODUCTOS WHERE ITEM_VENTAS.codigo_producto = 2
SELECT SUM(IV.cantidad) AS CANTIDAD_TOTAL,PR.nombre_producto FROM ITEM_VENTAS AS IV,PRODUCTOS AS PR WHERE PR.codigo_producto = IV.codigo_producto GROUP BY IV.codigo_producto ORDER BY CANTIDAD_TOTAL DESC
SELECT SUM(IV.cantidad) AS CANTIDAD_TOTAL,PR.nombre_producto FROM ITEM_VENTAS AS IV,PRODUCTOS AS PR WHERE PR.codigo_producto = IV.codigo_producto GROUP BY IV.codigo_producto HAVING CANTIDAD_TOTAL > 30 ORDER BY PR.nombre_producto
SELECT COUNT(numero_factura) AS COMPRAS, CLI.nombre FROM VENTAS,CLIENTES AS CLI WHERE CLI.codigo_cliente = VENTAS.codigo_cliente GROUP BY VENTAS.codigo_cliente ORDER BY CLI.nombre
SELECT AVG(IV.cantidad),IV.codigo_producto FROM ITEM_VENTAS AS IV,VENTAS AS V WHERE IV.numero_factura = V.numero_factura AND V.codigo_cliente=1 GROUP BY IV.codigo_producto

CREATE TABLE DOCUMENTOS(
	cod_documento INT,
    descripcion VARCHAR(20)
);
CREATE TABLE OFICINAS(
	cod_oficina INT,
    cod_director INT,
    descripcion VARCHAR(20)
);
CREATE TABLE EMPLEADOS(
	cod_empleado INT,
    apellido VARCHAR(20),
    nombre VARCHAR(20),
    fecha_nacimiento VARCHAR(20),
    num_doc VARCHAR(20),
    cod_jefe INT,
    cod_oficina INT,
    cod_documento INT
    
);
CREATE TABLE DATOS_CONTRATOS(
	cod_empleado INT,
    fecha_contrato VARCHAR(20),
    cuota INT,
    ventas INT
);
CREATE TABLE FABRICANTES();
CREATE TABLE LISTAS();
CREATE TABLE PRODUCTOS();
CREATE TABLE PRECIOS();
CREATE TABLE CLIENTES();
CREATE TABLE PEDIDOS();
CREATE TABLE DETALLE_PEDIDOS();